# Verbatim Studio - Basic Tier (CPU/ARM)
# For systems without NVIDIA GPU (Mac, Windows, Linux without GPU)

version: "3.9"

services:
  # WhisperX for file transcription (CPU mode)
  whisper-service:
    image: verbatim/whisper-service:cpu
    build:
      context: ../../services/whisper-service
      dockerfile: Dockerfile.cpu
    ports:
      - "8001:8001"
    volumes:
      - whisper-models:/app/models
      - uploads:/app/uploads
    environment:
      - WHISPER_MODEL_SIZE=small
      - WHISPER_DEVICE=cpu
      - WHISPER_COMPUTE_TYPE=int8

  # Speaker diarization (CPU)
  diarization:
    image: verbatim/diarization:cpu
    build:
      context: ../../services/diarization
      dockerfile: Dockerfile.cpu
    ports:
      - "8003:8000"
    volumes:
      - diarization-models:/app/models
    environment:
      - HF_TOKEN=${HF_TOKEN:-}
      - DEVICE=cpu

  # Ollama for local LLM
  ollama:
    image: ollama/ollama:latest
    ports:
      - "11434:11434"
    volumes:
      - ollama-data:/root/.ollama

volumes:
  whisper-models:
  diarization-models:
  ollama-data:
  uploads:
